<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>Aikau Audit Report | Sujay Pillai</title>
	<meta name="description" content="  EisenVault takes away the hassle of managing documents by storing them in both electronic and physical forms, enabling smart-search and deploying quick ret...">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-Frame-Options" content="sameorigin">

	<!-- CSS -->
	<link rel="stylesheet" href="/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/2015/09/18/aikau-audit-report.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Sujay Pillai" href="/feed.xml" />

	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">

  <!-- KaTeX -->
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.js"></script>
	

	<!-- Google Analytics -->
	
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-65644221-1', 'auto');
	ga('send', 'pageview');
	</script>
	
</head>

  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="/">
			<img class="avatar" src="/img/sop.png" alt=""/>
		</a>
		
		<h1 class="site-title">
			<a href="/">Sujay Pillai</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled -->
			


<li>
	<a href="mailto:sujayopillai@gmail.com" title="Email">
		<i class="fa fa-fw fa-envelope"></i>
	</a>
</li>













<li>
	<a href="https://github.com/sujaypillai" title="Follow on GitHub">
		<i class="fa fa-fw fa-github"></i>
	</a>
</li>







<li>
	<a href="https://www.linkedin.com/in/sujaypillai" title="Follow on LinkedIn">
		<i class="fa fa-fw fa-linkedin"></i>
	</a>
</li>















<li>
	<a href="https://twitter.com/sujaypillai" title="Follow on Twitter">
		<i class="fa fa-fw fa-twitter"></i>
	</a>
</li>






		</ul>
	</nav>
</header>

    <div class="content">
      <article >
  <header style="background-image: url('/')">
    <h1 class="title">Aikau Audit Report</h1>
    <p class="meta">
    September 18, 2015
    
    </p>
  </header>
  <section class="post-content"><blockquote>
  <p><a href="https://eisenvault.com">EisenVault</a> takes away the hassle of managing documents by storing them in both electronic and physical forms, enabling smart-search and deploying quick retrieval measures. Our innovative cloud-based document management system can be used in multiple industry sectors, and caters to specific requirements of various job roles. Our vision - to be your preferred partner for electronic and physical document management.</p>
</blockquote>

<p>This is <a href="https://eisenvault.com">EisenVault’s</a> first Aikau plugin and we would like to share our experience building it. While during the days when people used Alfresco Explorer there was an option to view the audit trail for a document using the show_audit.ftl by selecting <strong><em>“Preview in Template”</em></strong>.
Below is a screenshot of how it looked -</p>

<p><img src="/img/audit-example-explorer.jpg" alt="Alfresco Explorer Audit Trail" /></p>

<p>But there is no such option in Alfresco Share to view those audit data, so I thought of building it. Auditing is by default enabled in Alfresco but the data generation for the same is disabled and to enable this you would have to put in the below property in alfresco-global.properties.</p>

<div class="highlight"><pre><code class="language-properties" data-lang="properties"><span class="na">audit.alfresco-access.enabled</span><span class="o">=</span><span class="s">true</span></code></pre></div>

<p>You can check the status for auditing by issuing the command:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">curl -u admin:password &quot;http://localhost:8080/alfresco/service/api/audit/control&quot;</span></code></pre></div>

<p>On issuing the above command you would get a JSON response something similar -</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
       <span class="nt">&quot;enabled&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
       <span class="nt">&quot;applications&quot;</span><span class="p">:</span> 
       <span class="p">[</span>
          <span class="p">{</span>
             <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alfresco Tagging Service&quot;</span><span class="p">,</span>
             <span class="nt">&quot;path&quot;</span> <span class="p">:</span> <span class="s2">&quot;/tagging&quot;</span><span class="p">,</span>
             <span class="nt">&quot;enabled&quot;</span> <span class="p">:</span> <span class="kc">true</span>
          <span class="p">}</span>
             <span class="p">,</span>
          <span class="p">{</span>
             <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;alfresco-access&quot;</span><span class="p">,</span>
             <span class="nt">&quot;path&quot;</span> <span class="p">:</span> <span class="s2">&quot;/alfresco-access&quot;</span><span class="p">,</span>
             <span class="nt">&quot;enabled&quot;</span> <span class="p">:</span> <span class="kc">true</span>
          <span class="p">}</span>
             
       <span class="p">]</span>
<span class="p">}</span></code></pre></div>

<p>You can also query to retrieve the audit events:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">curl -u admin:password &quot;http://localhost:8080/alfresco/service/api/audit/query/alfresco-access?limit=2&quot;</span></code></pre></div>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
   <span class="nt">&quot;entries&quot;</span><span class="p">:</span> 
   <span class="p">[</span>
      <span class="p">{</span>
         <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
         <span class="nt">&quot;application&quot;</span><span class="p">:</span><span class="s2">&quot;alfresco-access&quot;</span><span class="p">,</span>
         <span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
         <span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2015-09-16T13:48:08.796+08:00&quot;</span><span class="p">,</span>
         <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="kc">null</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
         <span class="nt">&quot;application&quot;</span><span class="p">:</span><span class="s2">&quot;alfresco-access&quot;</span><span class="p">,</span>
         <span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
         <span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2015-09-16T13:48:09.560+08:00&quot;</span><span class="p">,</span>
         <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="kc">null</span>
      <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p><strong><em>If you looking for more information about Alfresco Audting you should definitely look <a href="http://docs.alfresco.com/5.0/concepts/audit-intro.html">here</a></em></strong></p>
</blockquote>

<h3 id="aikau-audit-report-page">Aikau Audit Report page</h3>
<ul>
  <li>
    <p>The new Aikau Audit report page lets you view the audit trail for each document in the repository as shown below:</p>

    <p><img src="/img/aikau-audit-report.png" alt="Aikau Audit Report" /></p>
  </li>
  <li>
    <p>You can access this page either from the document library action OR from the Document Actions section from the document details page:</p>

    <table>
      <tbody>
        <tr>
          <td><img class="class" src="/img/aar-dl.png" title="Document Library" alt="alt text" /></td>
          <td><img class="class" src="/img/aar-da.png" width="600" title="Document Actions" alt="alt text" /></td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="how-does-it-work">How does it work?</h3>
<ul>
  <li>The <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/AlfList.html">AlfList</a> widget makes a call to webscript <a href="https://github.com/vipulswarup/ev-aikau-auditreport/blob/master/ev-repo/src/main/java/com/eisenvault/webscript/NodeAuditTrailWebScript.java">NodeAuditTrailWebScript</a> with help of the attribute <strong><em>loadDataPublishTopic</em></strong> via the CrudService (using the “<strong>ALF_CRUD_GET_ALL</strong>” topic) which take the nodeRef as a parameter and this in turn returns the data in JSON format.</li>
  <li>Now to render the list what AlfList loads we need to create a view which is done with the help of <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/AlfListView.html">AlfListView</a>.</li>
  <li>As the list contains five columns we would be adding same number of <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/HeaderCell.html">HeaderCell</a> for the attribute <strong><em>widgetsForHeader</em></strong>.</li>
  <li>Each row in the data will be represented by <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/Row.html">Row</a> and each <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/Cell.html">Cell</a> will hold <a href="http://dev.alfresco.com/resource/docs/aikau-jsdoc/Property.html">Property</a> to render the value for respective <strong><em>Cell</em></strong>.</li>
  <li>As the last column “<strong>Audit Entry Values</strong>” holds multiple values the <strong><em>Property</em></strong> widget need to be overridden and you may find this in <a href="https://github.com/vipulswarup/ev-aikau-auditreport/blob/master/ev-share/src/main/amp/web/js/eisenvault/widgets/Property.js">Property.js</a></li>
</ul>

<p>** You may find the complete source code for this addon on <a href="https://github.com/vipulswarup/ev-aikau-auditreport">Github</a></p>

</section>
</article>

<!-- Disqus -->

<div class="comments">
  <div id="disqus_thread"></div>
<script type="text/javascript">
	var disqus_shortname = 'sujaypillai';
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>


    </div>
    <script src="/js/main.js"></script>


<footer class="site-footer">
	<p class="text">Powered by <a href="http://jekyllrb.com">Jekyll</a> with <a href="https://rohanchandra.github.io/project/type/">Type Theme</a>
</p>
</footer>


  </body>
</html>
